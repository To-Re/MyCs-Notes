# 1. 用户及文件权限管理

## 1.1 用户管理

`su <user>` 切换到用户 user，执行时需要输入目标用户密码

`sudo <cmd>` 可以以特权级别运行 cmd 命令，需要当前用户属于 sudo 组，且需要输入当前用户密码

`su - <user>` 切换用户，但是同时用户的环境变量和工作目录也会跟着改变为目标用户的



### 创建用户

`useradd 选项 用户名`

- 选项：
  - -d 目录：指定用户主目录，如果此目录不存在，则同时使用 -m 选项，可以创建主目录
  - -g 用户组：指定用户所属的用户组
  - -s Shell文件：指定用户的登录 Shell



### 查看用户信息

用户信息在 `/etc/passwd ` 文件中查看



### 删除账号

`userdel 选项 用户名`，常用选项 `-r` ，作用是将用户的主目录一起删除



### 修改账号

`usermod 选项 用户名`，常用选项及含义同创建用户，`-l 新用户名` 字面意思。



### 口令管理

`passwd 选项 用户名`

+ 选项：
  + -l 锁定口令，即禁用账号
  + -u 口令解锁
  + -d 使账号无口令
  + -f 强迫用户下次登录时修改口令
+ 如果是默认用户名（不加用户名），形式如下 `psaawd` ，则修改当前用户口令
+ 如果是超级用户可指定其他用户名，形式如下 `passwd 用户名` ，修改目标用户口令



## 1.2 用户组管理

### 创建用户组

`groupadd 选项 用户组`

+ 选项：
  + -g GID：指定新用户组的组标识号（GID）
  + -o：一般与 -g 同时用，表示新用户组的 GID 可以与系统已有用户组的 GID 现同



### 查看用户组信息

用户信息在 `/etc/group ` 文件中查看



### 删除用户组

`groupdel 用户组` ，不能删除任何用户的初始组，除非用户组不是任何用户的初始组才能删除。



### 修改用户组属性

`groupmod 选项 用户组`

+ 选项：
  + -g GID：指定新用户组的组标识号（GID）
  + -o：一般与 -g 同时用，表示新用户组的 GID 可以与系统已有用户组的 GID 现同
  + -n 新用户组：将用户组名改为新名字



### 用户在所属用户组之间切换

`newgrp 用户组` ，用户切换到其他用户组，需要该用户组中含有该用户。



# 2. Linux 文件权限

## 1.1 查看文件权限

`ls` 查看目录下信息，`-l` 参数详细显示，`-a` 参数显示隐藏。

```
wzy@wzypc:~$ ls -l
总用量 60
drwxr-xr-x  4 wzy wzy 4096 6月  16 21:04 codeforces
drwxr-xr-x  6 wzy wzy 4096 6月  16 10:06 learncpp
```

第一个字符表示文件类型：

+ `d` ：目录
+ `-` ：文件
+ `l` ：链接
+ `b` ：可供存储的接口设备



接下来 9 个字符每 3 个分一组，均为『rwx』即可读、可写、可执行，没有权限则是『-』。3 组从前到后分别表示，拥有者权限，所属用户组权限，其他用户权限。

后面字段依次表示：

+ 文件不是目录表示硬链接数，是目录表示子目录数
+ 文件拥有者
+ 文件所属用户组
+ 文件占用空间
+ 文件目录最近修改时间
+ 文件名



## 1.2 修改文件属性

### 属主及属组

`chown [-R] 用户名 文件名`

`chown [-R] 用户名:用户组名 文件名`

`chgrp [-R] 用户组名 文件名`

-R：递归更改文件



### 文件权限

`chmod [-R] xyz 文件或目录` ，xyz 表示 3 位整数 0~7。粗略解释，二进制分解 0 表示 『-』。

还有一种改变权限方法，

| 命令  | 身份        | 操作      | 权限 | 文件或目录 |
| ----- | ----------- | --------- | ---- | ---------- |
| chmod | u（用户）   | +（加入） | r    |            |
|       | g（用户组） | -（删除） | w    |            |
|       | o（其他）   | =（赋值） | x    |            |
|       | a（全部）   |           |      |            |

如设置 `-rwxr-xr--` ，可以使用 `chmod u=rwx,g=rx,o=r 文件名` 或 `chmod 754 文件名`

